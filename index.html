<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZEROX GOD</title>

<style>
body {
    margin:0;
    background:#000;
    overflow:hidden;
    font-family:Arial;
    color:#00f2ff;
}

#hud {
    position:fixed;
    top:20px;
    left:20px;
    z-index:10;
    font-size:12px;
}

/* STATUS OCULTO */
#status {
    display:none;
}

#start {
    position:fixed;
    bottom:30px;
    left:50%;
    transform:translateX(-50%);
    padding:20px 40px;
    background:#00f2ff;
    border:none;
    font-weight:bold;
    cursor:pointer;
}
</style>
</head>

<body>

<div id="hud">
    ZEROX GOD MODE
    <div id="status">AGUARDANDO...</div>
</div>

<button id="start">ATIVAR</button>
<div id="player"></div>

<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://www.youtube.com/iframe_api"></script>

<script>
// ================= CONFIG =================
const YOUTUBE_API_KEY = "AIzaSyCiYqB5IZRGMPxaBXLGqehItGwr7oG81Tw";

let player, recognition;
let synth = window.speechSynthesis;

let ativo = false;
let aguardandoConfirmacao = false;
let ultimoVolume = 100;

// ================= VOZ =================
function falar(texto){
    synth.cancel();
    let u = new SpeechSynthesisUtterance(texto);
    u.lang = "pt-BR";
    synth.speak(u);

    const el = document.getElementById("status");
    if(el) el.innerText = texto;
}

// ================= YOUTUBE =================
function onYouTubeIframeAPIReady(){
    player = new YT.Player('player',{
        height:'0',
        width:'0',
        events:{
            onReady:e=>e.target.mute()
        }
    });
}

async function tocar(termo){
    falar("Buscando " + termo);

    const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=id&q=${encodeURIComponent(termo)}&type=video&maxResults=1&key=${YOUTUBE_API_KEY}`);
    const data = await res.json();

    if(data.items[0]){
        const id = data.items[0].id.videoId;

        player.loadVideoById(id);

        setTimeout(()=>{
            player.unMute();
            player.setVolume(100);
        },500);

        falar("Tocando agora");
    }
}

// ================= IA =================
function responder(fala){

    // ATIVADOR
    if(fala.includes("zero x") || fala.includes("zerox")){
        if(player){
            ultimoVolume = player.getVolume();
            player.setVolume(10);
        }
        falar("Pode falar");
        return;
    }

    // CONFIRMAÇÃO
    if(aguardandoConfirmacao){
        if(fala.includes("sim")){
            player.setVolume(ultimoVolume);
            falar("Continuando");
        }else{
            player.stopVideo();
            falar("Música parada");
        }
        aguardandoConfirmacao = false;
        return;
    }

    // COMANDOS
    if(fala.includes("hora")){
        falar("Agora são " + new Date().toLocaleTimeString());

        if(player && player.getPlayerState() === 1){
            aguardandoConfirmacao = true;
            falar("Deseja continuar a música?");
        }
    }

    else if(fala.includes("toca")){
        let termo = fala.replace("toca","").trim();
        tocar(termo);
    }
}

// ================= VOICE =================
function iniciarVoz(){
    const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;

    recognition = new Speech();
    recognition.lang = "pt-BR";
    recognition.continuous = true;

    recognition.onresult = e=>{
        const fala = e.results[e.results.length-1][0].transcript.toLowerCase();
        responder(fala);
    };

    recognition.start();
}

function pararVoz(){
    if(recognition) recognition.stop();
}

// ================= 3D =================
const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
camera.position.z = 5;

const renderer = new THREE.WebGLRenderer({alpha:true});
renderer.setSize(innerWidth,innerHeight);
document.body.appendChild(renderer.domElement);

// GLOBO
const geo = new THREE.SphereGeometry(1.6,64,64);
const base = geo.attributes.position.array.slice();

const globe = new THREE.Points(
    geo,
    new THREE.PointsMaterial({color:0x00f2ff,size:0.015})
);

scene.add(globe);

// PARTÍCULAS
const pGeo = new THREE.BufferGeometry();
const arr = new Float32Array(1500*3);

for(let i=0;i<arr.length;i++){
    arr[i]=(Math.random()-0.5)*20;
}

pGeo.setAttribute('position',new THREE.BufferAttribute(arr,3));

const particles = new THREE.Points(
    pGeo,
    new THREE.PointsMaterial({size:0.02,color:0x00f2ff})
);

scene.add(particles);

// ================= ANIMAÇÃO =================
let explosionFactor = 1;
let pulse = 1;

function animate(){
    requestAnimationFrame(animate);

    pulse += 0.1;

    let tocando = player && player.getPlayerState && player.getPlayerState() === 1;
    let target = tocando ? 3 : 1;

    explosionFactor += (target - explosionFactor)*0.08;

    const attr = globe.geometry.attributes.position;

    for(let i=0;i<attr.count;i++){
        const scale = explosionFactor + Math.sin(i+pulse)*0.05;

        attr.setXYZ(
            i,
            base[i*3]*scale,
            base[i*3+1]*scale,
            base[i*3+2]*scale
        );
    }

    attr.needsUpdate = true;

    globe.rotation.y += 0.003;
    particles.rotation.y += 0.0005;

    renderer.render(scene,camera);
}

animate();

// ================= START =================
document.getElementById("start").onclick = ()=>{
    ativo = !ativo;

    if(ativo){
        falar("Zero X iniciado");
        iniciarVoz();
        document.getElementById("start").innerText = "DESATIVAR";
    }else{
        pararVoz();
        if(player) player.stopVideo();
        falar("Desativado");
        document.getElementById("start").innerText = "ATIVAR";
    }
};
</script>

</body>
</html>
