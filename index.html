<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ZeroX v3</title>
    <style>
        body { margin: 0; padding: 0; background: black; overflow: hidden; color: #00f2ff; font-family: 'Segoe UI', sans-serif; }
        #ui-layer { position: fixed; top: 20px; left: 20px; font-size: 10px; letter-spacing: 2px; z-index: 10; font-weight: bold; }
        
        .btn-container { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); display: flex; gap: 15px; z-index: 20; }
        
        button { 
            padding: 15px 30px; background: rgba(0, 0, 0, 0.8); color: #00f2ff; 
            border: 1px solid #00f2ff; cursor: pointer; font-weight: 800; text-transform: uppercase;
            letter-spacing: 1px; transition: 0.3s;
        }
        button:hover { background: #00f2ff; color: black; box-shadow: 0 0 25px #00f2ff; }
        
        #status-zero { position: fixed; top: 50px; left: 20px; font-size: 14px; color: #fff; background: rgba(0,0,0,0.5); padding: 5px 10px; border-left: 3px solid #00f2ff; }
        #yt-player { position: absolute; top: -1000px; left: -1000px; } /* Totalmente escondido */
    </style>
</head>
<body>

<div id="ui-layer">ZEROX_v1.0</div>
<div id="status-zero">SISTEMA OFFLINE</div>

<div class="btn-container">
    <button id="startBtn" onclick="initExperience()">INICIAR ZEROX</button>
    <button id="voiceBtn" onclick="toggleVoice()" style="display:none;">COMANDO DE VOZ</button>
</div>

<video id="webcam" style="display:none;" autoplay playsinline></video>
<div id="yt-player"></div>

<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script src="https://www.youtube.com/iframe_api"></script>

<script>
    let recognition;
    let synth = window.speechSynthesis;
    let player;
    let hands;

    // --- CONFIGURAÇÃO VISUAL (3D) ---
    const scene = new THREE.Scene();
    const camera3D = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    // Globo
    const particleCount = 3500;
    const geo = new THREE.BufferGeometry();
    const pos = new Float32Array(particleCount * 3);
    for(let i=0; i<particleCount; i++){
        const r = 1.6; const t = 2*Math.PI*Math.random(); const p = Math.acos(2*Math.random()-1);
        pos[i*3] = r*Math.sin(p)*Math.cos(t); pos[i*3+1] = r*Math.sin(p)*Math.sin(t); pos[i*3+2] = r*Math.cos(p);
    }
    geo.setAttribute('position', new THREE.BufferAttribute(pos, 3));
    const globe = new THREE.Points(geo, new THREE.PointsMaterial({color: 0x00f2ff, size: 0.015}));
    scene.add(globe);

    // Mão Geométrica (Melhorada para ser rápida)
    const handGroup = new THREE.Group(); scene.add(handGroup);
    const joints = []; 
    for(let i=0; i<21; i++){
        const m = new THREE.Mesh(new THREE.IcosahedronGeometry(0.025,0), new THREE.MeshBasicMaterial({color: 0xffffff}));
        joints.push(m); handGroup.add(m);
    }
    const linesGroup = new THREE.Group(); handGroup.add(linesGroup);
    const lineMat = new THREE.LineBasicMaterial({color: 0x00f2ff, transparent: true, opacity: 0.6});
    const HAND_CONN = [[0,1],[1,2],[2,3],[3,4],[0,5],[5,6],[6,7],[7,8],[5,9],[9,10],[10,11],[11,12],[9,13],[13,14],[14,15],[15,16],[13,17],[17,18],[18,19],[19,20],[0,17]];
    camera3D.position.z = 5;

    // --- SISTEMA DE VOZ MASCULINA ---
    function falar(texto) {
        // Cancelar falas anteriores para evitar delay
        synth.cancel();
        const utter = new SpeechSynthesisUtterance(texto);
        
        // Tenta pegar uma voz masculina disponível no sistema
        const voices = synth.getVoices();
        utter.voice = voices.find(v => v.name.includes('Google') && v.lang.includes('pt')) || voices[0];
        
        utter.pitch = 0.6; // Tom mais baixo (homem)
        utter.rate = 1.0; 
        synth.speak(utter);
        document.getElementById('status-zero').innerText = "ZEROX: " + texto;
    }

    function initVoiceRecognition() {
        const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(!Speech) return alert("Seu navegador não suporta voz.");
        
        recognition = new Speech();
        recognition.lang = 'pt-BR';
        recognition.continuous = false;

        recognition.onresult = (event) => {
            const comando = event.results[0][0].transcript.toLowerCase();
            processarComando(comando);
        };
    }

    function processarComando(cmd) {
        console.log("Comando recebido:", cmd);
        
        if (cmd.includes("hora")) {
            const h = new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
            falar("Agora são exatamente " + h);
        } 
        else if (cmd.includes("tocar") || cmd.includes("música")) {
            const musica = cmd.replace("tocar", "").replace("música", "").trim();
            falar("Localizando " + musica + ". O áudio iniciará em instantes. Lembre-se que este conteúdo pode ter anúncios.");
            
            // Simulação de busca: Carrega o primeiro hit de busca do YT
            // Em produção, você usaria uma URL de busca ou ID específico
            player.cuePlaylist({listType: 'search', list: musica});
            setTimeout(() => { player.playVideo(); }, 2000);
        }
        else {
            falar("Comando " + cmd + " não reconhecido.");
        }
    }

    function toggleVoice() {
        try { recognition.start(); document.getElementById('status-zero').innerText = "ESCUTANDO..."; } catch(e){}
    }

    // --- INICIALIZAÇÃO DO SISTEMA ---
    function onYouTubeIframeAPIReady() {
        player = new YT.Player('yt-player', {
            height: '0', width: '0',
            events: { 'onReady': () => console.log("Som pronto") }
        });
    }

    async function initExperience() {
        document.getElementById('startBtn').style.display = 'none';
        document.getElementById('voiceBtn').style.display = 'block';
        
        initVoiceRecognition();
        // Escrita fonética para ele não falar "Zerókis"
        falar("Olá, sou o Zero Xis. Em que posso te ajudar hoje?");

        hands = new Hands({locateFile: (file) => `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`});
        hands.setOptions({maxNumHands: 1, modelComplexity: 1, minDetectionConfidence: 0.75, minTrackingConfidence: 0.75});
        
        hands.onResults(res => {
            while(linesGroup.children.length > 0) linesGroup.remove(linesGroup.children[0]);
            if(res.multiHandLandmarks && res.multiHandLandmarks[0]){
                const pts = res.multiHandLandmarks[0];
                pts.forEach((p,i) => {
                    const x = -(p.x-0.5)*8; const y = -(p.y-0.5)*6; const z = -p.z*4;
                    joints[i].position.set(x, y, z);
                });
                HAND_CONN.forEach(c => {
                    const l = new THREE.BufferGeometry().setFromPoints([joints[c[0]].position, joints[c[1]].position]);
                    linesGroup.add(new THREE.Line(l, lineMat));
                });
            }
        });

        const cam = new Camera(document.getElementById('webcam'), {
            onFrame: async () => { await hands.send({image: document.getElementById('webcam')}); },
            width: 1280, height: 720
        });
        cam.start();
    }

    function animate() {
        requestAnimationFrame(animate);
        globe.rotation.y += 0.003;
        renderer.render(scene, camera3D);
    }
    animate();

    window.addEventListener('resize', () => {
        camera3D.aspect = window.innerWidth / window.innerHeight;
        camera3D.updateProjectionMatrix();
        renderer.setSize(window.innerWidth, window.innerHeight);
    });
</script>

</body>
</html>




