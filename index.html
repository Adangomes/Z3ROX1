<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Hand + Planeta 3D</title>

<style>
body {
  margin: 0;
  background: black;
  overflow: hidden;
}

/* Canvas principal */
canvas {
  position: absolute;
  top: 0;
  left: 0;
}

/* BotÃ£o */
#startBtn {
  position: fixed;
  bottom: 20px;
  left: 20px;
  padding: 12px 20px;
  background: #00ffff;
  color: black;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  z-index: 10;
}
</style>
</head>

<body>

<button id="startBtn">Ativar CÃ¢mera</button>

<video id="video" autoplay playsinline style="display:none;"></video>
<canvas id="canvas"></canvas>

<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let handX = canvas.width / 2;
let handY = canvas.height / 2;

// ðŸŒŒ PLANETA (pontos)
function drawPlanet() {
  const centerX = handX;
  const centerY = handY;

  for (let i = 0; i < 2000; i++) {
    const angle = Math.random() * Math.PI * 2;
    const radius = 100;

    const x = centerX + Math.cos(angle) * radius;
    const y = centerY + Math.sin(angle) * radius;

    ctx.fillStyle = "#00aaff";
    ctx.fillRect(x, y, 2, 2);
  }

  // anel
  for (let i = 0; i < 1500; i++) {
    const angle = Math.random() * Math.PI * 2;
    const radius = 160;

    const x = centerX + Math.cos(angle) * radius;
    const y = centerY + Math.sin(angle) * radius * 0.4;

    ctx.fillStyle = "#00ffff";
    ctx.fillRect(x, y, 2, 2);
  }
}

// â­ estrelas
function drawStars() {
  for (let i = 0; i < 200; i++) {
    ctx.fillStyle = "white";
    ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 1, 1);
  }
}

// ðŸ–ï¸ MediaPipe
const hands = new Hands({
  locateFile: (file) => {
    return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
  }
});

hands.setOptions({
  maxNumHands: 1,
  minDetectionConfidence: 0.7,
  minTrackingConfidence: 0.7
});

hands.onResults(results => {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  drawStars();

  if (results.multiHandLandmarks) {
    const p = results.multiHandLandmarks[0][8]; // ponta do dedo

    handX = p.x * canvas.width;
    handY = p.y * canvas.height;
  }

  drawPlanet();
});

// ðŸŽ¥ iniciar cÃ¢mera (corrigido iPhone)
document.getElementById("startBtn").onclick = () => {

  const camera = new Camera(video, {
    onFrame: async () => {
      await hands.send({ image: video });
    },
    width: 640,
    height: 480
  });

  camera.start();

  document.getElementById("startBtn").style.display = "none";
};
</script>

</body>
</html>